generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id               String       @id @default(uuid())
  username         String       @unique
  passwordHash     String
  pluralKey        String?
  overridePluralId String?
  admin            Boolean      @default(false)
  members          UserMember[]
  fields           UserField[]
  data             UserData?    @relation(fields: [dataId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  dataId           String?      @unique
}

model UserData {
  id          String  @id @default(uuid())
  slug        String?
  description String?
  visible     Boolean
  user        User?
}

model UserField {
  id     String         @id @default(uuid())
  pluralId String @unique
  pluralOwnerId String
  user   User?          @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  data   UserFieldData? @relation(fields: [dataId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  dataId String?        @unique
  userId String?
}

model UserFieldData {
  id          String     @id @default(uuid())
  description String?
  visible     Boolean
  field       UserField?
}

model UserMember {
  id            String          @id @default(uuid())
  pluralId      String          @unique
  pluralOwnerId String
  user          User            @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId        String
  data          UserMemberData? @relation(fields: [dataId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  dataId        String?         @unique
}

model UserMemberData {
  id          String      @id @default(uuid())
  slug        String?
  description String?
  visible     Boolean
  member      UserMember?
}
